apply plugin: 'com.android.library'

def safeExtGet(prop, fallback) {
    rootProject.ext.has(prop) ? rootProject.ext.get(prop) : fallback
}

repositories {
    flatDir {
        dirs 'libs'
    }
}

android {
    compileSdkVersion safeExtGet('compileSdkVersion', 27)
    buildToolsVersion safeExtGet('buildToolsVersion', '27.0.3')

    defaultConfig {
        minSdkVersion safeExtGet('minSdkVersion', 16)
        targetSdkVersion safeExtGet('targetSdkVersion', 27)
        versionCode 1
        versionName "1.0"
    }

    configurations.all {
        resolutionStrategy {
            force 'androidx.customview:customview:1.0.0'
            force 'androidx.core:core:1.1.0'
        }
    }
}

dependencies {
    //noinspection GradleDynamicVersion
    provided "com.facebook.react:react-native:${safeExtGet('reactNativeVersion', '+')}"
    implementation(name: "exoplayer-library-smoothstreaming-release", ext: "aar")
    implementation(name: "exoplayer-library-core-release", ext: "aar")
    implementation(name: "exoplayer-library-ui-release", ext: "aar")
    implementation(name: "exoplayer-library-release", ext: "aar")
    implementation(name: "exoplayer-library-dash-release", ext: "aar")
    implementation(name: "exoplayer-library-common-release", ext: "aar")
    implementation(name: "exoplayer-library-extractor-release", ext: "aar")
    implementation(name: "exoplayer-library-hls-release", ext: "aar")
    implementation(name: "exoplayer-extension-okhttp-release", ext: "aar") {
        exclude group: 'com.squareup.okhttp3', module: 'okhttp'
    }
    implementation(name: "exoplayer-testdata-release", ext: "aar")
    implementation(name: "exoplayer-testutils-release", ext: "aar")

    implementation ('com.google.guava:guava:27.1-android') {
        exclude group: 'com.google.code.findbugs', module: 'jsr305'
        exclude group: 'org.checkerframework', module: 'checker-compat-qual'
        exclude group: 'com.google.errorprone', module: 'error_prone_annotations'
        exclude group: 'com.google.j2objc', module: 'j2objc-annotations'
        exclude group: 'org.codehaus.mojo', module: 'animal-sniffer-annotations'
    }

    // All support libs must use the same version
    compile "androidx.annotation:annotation:1.1.0"
    compile "androidx.core:core:1.1.0"
    compile "androidx.media:media:1.1.0"
}
